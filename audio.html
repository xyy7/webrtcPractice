<!DOCTYPE html>
<html>

<body>
    <audio id="local-audio" autoplay controls>播放麦克风捕获的声音</audio>
    <button id="showAudio">打开麦克风</button>
    <p>通过getUserMedia()获取音频</p>
</body>

<script>
    const constraints = { video: false, audio: true };
    //处理打开麦克风成功
    function handleSuccess(stream) {
        const audio = document.querySelector("#local-audio");
        audio.srcObject = stream;
    }
    // 异常处理
    function handleError(error) {
        console.error("getUserMedia error: " + error);
    }


    function onOpenMicrophone(e) {
        navigator.mediaDevices.getUserMedia(constraints).then(handleSuccess).catch(handleError);
    }

    document.querySelector("#showAudio").addEventListener("click", onOpenMicrophone);
</script>

</html>